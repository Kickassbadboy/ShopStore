<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <title>JsStorage Example</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link href="../materialize/css/materialize.min.css" rel="stylesheet " type="text/css" />
    <script src="../scripts/jquery.js"></script>
    <script src="../scripts/jsvalidator.js"></script>
    <script src="../materialize/js/materialize.min.js"></script>
    <script src="../scripts/matdialog.min.js"></script>
    <link href="../Style/matdialog.min.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <ul id="listCustomer" class="dropdown-content">
        <li><a href="../customer/add.html">Add</a></li>
        <li><a href="../customer/index.html">List</a></li>
    </ul>
    <ul id="listStock" class="dropdown-content">
        <li><a href="../stock/add.html">Add</a></li>
        <li><a href="../stock/index.html">List</a></li>
    </ul>
    <nav class="nav-extended">
        <div class="nav-wrapper">
            <ul id="nav-mobile" class="right">
                <li><a href="../index.html">Home</a></li>
                <li><a class="dropdown-button" href="#!" data-activates="listCustomer">Customer<i class="material-icons right">arrow_drop_down</i></a></li>
                <li class="active"><a class="dropdown-button" href="#!" data-activates="listStock">Stock<i class="material-icons right">arrow_drop_down</i></a></li>
            </ul>
            <div class="brand-logo center-align">
                <a href="#" title="Download MatDialog" class="logo">ShopDemo</a><br>
            </div>
        </div>
    </nav>
    <div class="row center-align">
        <form class="col s12 m8 l6 xl4 push-s0 push-m2 push-l3 push-xl4 right-alert">
            <h5 class="#bf360c deep-orange darken-4 color-white padding-10-px">Add Items In Store</h5>
            <div class="input-field col s12">
                <input placeholder="Enter Item Name" id="txtName" type="text" class="validate">
                <label for="txtName" data-error="wrong" data-success="right">Item Name</label>
            </div>
            <div class="input-field col s12">
                <input placeholder="Enter Item Price" id="txtPrice" type="text" class="validate">
                <label for="txtPrice" data-error="wrong" data-success="right">Item Price</label>
            </div>
            <div class="input-field col s12">
                <input placeholder="Enter Item Quantity" id="txtQuantity" type="number" class="validate">
                <label for="txtQuantity" data-error="wrong" data-success="right">Item Quantity</label>
            </div>
            <a class="waves-effect waves-light btn" onclick="isInputValid();"><i class="material-icons left">done</i>Add</a>
            <a class="waves-effect waves-light btn"><i class="material-icons left">close</i>Cancel</a>
        </form>
    </div>
    <link href="../style/main.css" rel="stylesheet " type="text/css" />
    <script src="../Scripts/JsStorage.js"></script>
    <script src="../Scripts/DbStructure.js"></script>
    <script src="../Scripts/main.js"></script>
    <script>
        function isInputValid() {
            var EItemName = $('#txtName'),
                EItemPrice = $('#txtPrice'),
                EItemQuantity = $('#txtQuantity'),
                ErrorOccured = false;

            if (Validator.isInvalid(EItemName.val())) {
                ErrorOccured = true;
                EItemName.addClass('invalid').next().attr('data-error', Validator.ErrMsg);
            }
            if (Validator.isInvalid(EItemPrice.val(), {
                    Type: "number"
                })) {
                ErrorOccured = true;
                EItemPrice.addClass('invalid').next().attr('data-error', Validator.ErrMsg);
            }
            if (Validator.isInvalid(EItemQuantity.val(), {
                    Type: 'number'
                })) {
                ErrorOccured = true;
                EItemQuantity.addClass('invalid').next().attr('data-error', Validator.ErrMsg);
            }

            if (!ErrorOccured) {
                var Value = {
                    ItemName: EItemName.val(),
                    Price: Number(EItemPrice.val()),
                    Quantity: Number(EItemQuantity.val())
                };
                Db.DbConnection.insert({
                    Into: "Stock",
                    Values: [Value]
                }, function (rowsCount) {
                    if (rowsCount > 0) {
                        DialogBox.alert('Successfully Added');
                        $('form')[0].reset();
                    }
                }, function (error) {
                    if (error) {
                        DialogBox.alert('Error Occured');
                    }
                    console.log(error);
                })
            }
        }
    </script>
</body>

</html>